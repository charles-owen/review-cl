(()=>{"use strict";var e,t={94775:(e,t,i)=>{var s=i(81525),r=i.n(s),n=i(40836),a={insert:"head",singleton:!1};r()(n.Z,a);n.Z.locals;var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"content"},[i("div",{staticClass:"full cl-reviewing"},[i("membersfetcher",{attrs:{fetching:null===e.reviewer},scopedSlots:e._u([{key:"default",fn:function(t){return[e.user.atLeast(e.instructor)?i("div",[i("form",{attrs:{method:"post"},on:{submit:function(t){return t.preventDefault(),e.assignReviews.apply(null,arguments)}}},[i("p",{staticClass:"center"},[i("button",{attrs:{type:"submit"}},[e._v("Assign Reviews")]),e._v(" "),i("select",{directives:[{name:"model",rawName:"v-model",value:e.reviewerCnt,expression:"reviewerCnt"}],on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.reviewerCnt=t.target.multiple?i:i[0]}}},e._l(6,(function(t){return i("option",{domProps:{value:t}},[e._v(e._s(t))])})),0)])])]):e._e(),e._v(" "),i("table",{staticClass:"small"},[i("tr",[i("th",[e._v("Name")]),e._v(" "),i("th",[e._v("User ID")]),e._v(" "),e._l(e.maxReviewer,(function(t){return i("th",[e._v("reviewee")])})),e._v(" "),e._l(e.maxReviewee,(function(t){return i("th",[e._v("reviewer")])}))],2),e._v(" "),e._l(t.users,(function(s){return i("tr",[i("td",{staticClass:"small"},[i("router-link",{attrs:{title:s.name,to:e.root+"/cl/console/grading/"+e.assigntag+"/"+s.member.id}},[e._v("\n                "+e._s(s.name)+"\n              ")])],1),e._v(" "),i("td",[i("router-link",{attrs:{title:s.name,to:e.root+"/cl/console/grading/"+e.assigntag+"/"+s.member.id}},[e._v("\n                "+e._s(s.userId)+"\n              ")])],1),e._v(" "),e._l(e.maxReviewer,(function(r){return i("td",{class:e.cls(e.reviewer[s.member.id],r-1)},[i("status-present",{attrs:{assigntag:e.assigntag,"status-user":e.displayUser(t.users,e.reviewer[s.member.id],r-1),count:void 0!==e.reviewer[s.member.id]?e.reviewer[s.member.id][r-1][1]:0}})],1)})),e._v(" "),e._l(e.maxReviewee,(function(r){return i("td",{class:e.cls(e.reviewee[s.member.id],r-1)},[i("status-present",{attrs:{assigntag:e.assigntag,"status-user":e.displayUser(t.users,e.reviewee[s.member.id],r-1),count:void 0!==e.reviewer[s.member.id]?e.reviewer[s.member.id][r-1][1]:0}})],1)}))],2)}))],2)]}}])})],1)])};o._withStripped=!0;var v=function(){var e=this,t=e.$createElement,i=e._self._c||t;return null!==e.statusUser?i("router-link",{attrs:{to:e.root+"/cl/console/grading/"+e.assigntag+"/"+e.statusUser.member.id,title:e.statusUser.name}},[e._v(e._s(e.statusUser.userId)+"/"+e._s(e.count))]):e._e()};v._withStripped=!0;const l={extends:Site.Site.ConsoleComponentBase,props:["assigntag","statusUser","count"]};var u=i(36337),c=(0,u.Z)(l,v,[],!1,null,null,null);c.options.__file="vendor/cl/review/js/Console/StatusPresent.vue";const f=c.exports;function m(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return h(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var s=0,r=function(){};return{s:r,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,o=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){o=!0,n=e},f:function(){try{a||null==i.return||i.return()}finally{if(o)throw n}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=e[i];return s}const w={extends:Site.Site.ConsoleComponentBase,props:["assigntag"],data:function(){return{assignment:null,reviewerCnt:2,reviewing:"x",instructor:Site.Site.Member.INSTRUCTOR,reviewer:null,reviewee:null,maxReviewer:0,maxReviewee:0}},components:{membersfetcher:Site.MembersFetcherComponentVue,"status-present":f},mounted:function(){var e=this,t=this.$store.state.user.user.member;this.section=this.$store.getters["course/section"](t.semester,t.section),this.assignment=this.section.getAssignment(this.assigntag),this.setTitle(": "+this.assignment.shortname+" Reviewing"),this.$site.api.get("/api/review/reviewers/"+this.assigntag,{}).then((function(t){t.hasError()?e.$site.toast(e,t):e.take(t)})).catch((function(t){e.$site.toast(e,t)}))},methods:{assignReviews:function(){var e=this;this.maxReviewer>0||this.maxReviewee>0?new this.$site.Dialog.MessageBox("Are you sure?","Are you sure you want to assign reviewers? This will replace the existing reviewing assignments.",this.$site.Dialog.MessageBox.OKCANCEL,(function(){e.assignReviewsActual()})):this.assignReviewsActual()},assignReviewsActual:function(){var e=this;this.reviewer=null,this.reviewee=null,this.maxReviewer=0,this.maxReviewee=0;var t={cnt:this.reviewerCnt};this.$site.api.post("/api/review/reviewers/"+this.assigntag,t).then((function(t){t.hasError()?e.$site.toast(e,t):e.take(t)})).catch((function(t){e.$site.toast(e,t)}))},take:function(e){var t=e.getData("reviewers").attributes;this.reviewer={},this.reviewee={},this.maxReviewer=0,this.maxReviewee=0;var i,s=m(t);try{for(s.s();!(i=s.n()).done;){var r=i.value,n=+r[0],a=+r[1],o=+r[2];void 0===this.reviewer[n]&&(this.reviewer[n]=[]),this.reviewer[n].push([a,o]),this.reviewer[n].length>this.maxReviewer&&(this.maxReviewer=this.reviewer[n].length),void 0===this.reviewee[a]&&(this.reviewee[a]=[]),this.reviewee[a].push([n,o]),this.reviewee[a].length>this.maxReviewee&&(this.maxReviewee=this.reviewer[n].length)}}catch(e){s.e(e)}finally{s.f()}},displayUser:function(e,t,i){if(void 0===t||i>=t.length)return null;var s,r=m(e);try{for(r.s();!(s=r.n()).done;){var n=s.value;if(n.member.id===t[i][0])return n}}catch(e){r.e(e)}finally{r.f()}return null},cls:function(e,t){return void 0===e||t>=e.length?"":e[t][1]<1?"cl-empty":""}}};var d=(0,u.Z)(w,o,[],!1,null,null,null);d.options.__file="vendor/cl/review/js/Console/ReviewReviewers.vue";const p=d.exports;var g=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"cl-reviews"},[i("h2",[e._v("Staff Review")]),e._v(" "),i("form",{attrs:{method:"post"},on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[i("div",{ref:"editor"}),e._v(" "),e._m(0)]),e._v(" "),i("h3",[e._v("Reviews by this user.")]),e._v(" "),0===e.byReviews.length?i("p",{staticClass:"center"},[e._v("None")]):e._e(),e._v(" "),e._l(e.byReviews,(function(t){return i("div",{staticClass:"cl-review"},[i("h3",{class:t.reviewee.atLeast(e.staffRole)?"staff":""},[e._v(e._s(e.formatTime(t.time))+" Review by "+e._s(t.reviewee.name)+"\n      "),i("span",{staticClass:"cl-submitted"},[e._v(e._s(e.showSubmissions(t)))])]),e._v(" "),i("div",{staticClass:"cl-review-present"},[e._v(e._s(t.meta.review.review))])])})),e._v(" "),i("h3",[e._v("Reviews of this user's assignment.")]),e._v(" "),0===e.forReviews.length?i("p",{staticClass:"center"},[e._v("None")]):e._e(),e._v(" "),e._l(e.forReviews,(function(t){return i("div",{staticClass:"cl-review"},[i("h3",{class:t.reviewer.atLeast(e.staffRole)?"staff":""},[e._v(e._s(e.formatTime(t.time))+"\n      "),t.reviewer.atLeast(e.staffRole)?i("span",[e._v("Staff Review")]):i("span",[e._v("Review")]),e._v(" by "+e._s(t.reviewer.name)+"\n      "),i("span",{staticClass:"cl-submitted"},[e._v(e._s(e.showSubmissions(t)))])]),e._v(" "),i("div",{staticClass:"cl-review-present"},[e._v(e._s(t.meta.review.review))])])}))],2)};function _(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return b(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var s=0,r=function(){};return{s:r,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,o=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){o=!0,n=e},f:function(){try{a||null==i.return||i.return()}finally{if(o)throw n}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=e[i];return s}g._withStripped=!0;const y={props:["user","assigntag"],data:function(){return{forReviews:[],byReviews:[],staffRole:Site.Site.Member.STAFF,submissions:[]}},watch:{user:function(){this.forReviews=[],this.byReviews=[],this.submissions=[],this.fetch()}},mounted:function(){var e=this.$refs.editor;this.editor=new this.$site.Editor(e,{height:"10em",classes:["yellow-pad"]}),this.fetch()},methods:{fetch:function(){var e=this;this.$site.api.get("/api/review/reviews/"+this.assigntag+"/"+this.user.member.id,{}).then((function(t){t.hasError()?e.$site.toast(e,t):e.take(t)})).catch((function(t){e.$site.toast(e,t)}))},take:function(e){var t=e.getData("reviews-by-for").attributes,i=e.getData("assignment-submissions");null!==i&&(this.submissions=i.attributes);var s,r=_(t.for);try{for(r.s();!(s=r.n()).done;){var n=s.value;n.reviewer=new Site.User(n.reviewer)}}catch(e){r.e(e)}finally{r.f()}var a,o=_(t.by);try{for(o.s();!(a=o.n()).done;){var v=a.value;v.reviewee=new Site.User(v.reviewee)}}catch(e){o.e(e)}finally{o.f()}this.forReviews=t.for,this.byReviews=t.by},submit:function(){var e=this,t=this.editor.textarea.value.trim();if(""!==t){var i={};for(var s in this.submissions)console.log(this.submissions[s]),i[s]={id:this.submissions[s][0].id,date:this.submissions[s][0].date};var r={type:"text/plain",text:t,submissions:i};Site.api.post("/api/review/staffreview/".concat(this.assigntag,"/").concat(this.user.member.id),r).then((function(t){t.hasError()?Site.toast(e,t):(e.editor.textarea.value="",e.take(t),Site.toast(e,"Review successfully saved to the server"))})).catch((function(t){Site.toast(e,t)}))}else Site.toast(this,"You must enter some text to submit")},formatTime:function(e){return this.$site.TimeFormatter.relativeUNIX(e,null)},showSubmissions:function(e){var t=e.meta.review.submissions,i="";for(var s in t)i+=this.$site.TimeFormatter.absoluteUNIX(t[s].date);return""===i?"":"Submission: "+i}}};var S=(0,u.Z)(y,g,[function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("input",{attrs:{type:"submit",value:"Submit Review"}})])}],!1,null,null,null);S.options.__file="vendor/cl/review/js/Console/ReviewsByForMember.vue";const R=S.exports;var x=function(){};x.setup=function(e){e.Review={reviewsbyfor:R},e.tables.add({title:"Review",order:70,api:"/api/review/tables"}),e.components.addRoute({route:"/review/reviewers/:assigntag",component:p,props:!0}),e.course.assignmentLink("review","reviewers","/review/reviewers/:assigntag")};var C=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"content"},[i("div",{staticClass:"full"},[e._l(e.json.submissions,(function(t){return i("div",{staticClass:"cl-submission-view"},[i("h2",[e._v(e._s(t.name))]),e._v(" "),"text"===t.type?i("pre",{staticClass:"cl-preview yellow-pad"},[e._v(e._s(t.text))]):e._e(),e._v(" "),"image"===t.type?i("figure",{staticClass:"cl-preview"},[i("img",{attrs:{src:e.previewImg(t)}})]):e._e(),e._v(" "),i("p",{staticClass:"cl-preview-time"},[e._v(e._s(e.formatTime(t.date)))])])})),e._v(" "),i("h2",[e._v("Review")]),e._v(" "),i("form",{attrs:{method:"post"},on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[i("div",{ref:"editor",staticClass:"shadow"}),e._v(" "),e._m(0)]),e._v(" "),i("h2",[e._v("Previous Reviews")]),e._v(" "),0===e.reviewing.length?i("p",{staticClass:"cl-reviews-none"},[e._v("*** None Yet ***")]):e._e(),e._v(" "),e._l(e.reviewing,(function(t){return i("div",{staticClass:"cl-review"},[i("h3",[e._v(e._s(e.formatTime(t.time))+" Review by Me\n        "),i("span",{staticClass:"cl-submitted"},[e._v(e._s(e.showSubmissions(t)))])]),e._v(" "),i("div",{staticClass:"cl-review-present"},[e._v(e._s(t.meta.review.review))])])}))],2)])};function $(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return j(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var s=0,r=function(){};return{s:r,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,o=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){o=!0,n=e},f:function(){try{a||null==i.return||i.return()}finally{if(o)throw n}}}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=e[i];return s}C._withStripped=!0;const T={extends:Site.Site.UserVueBase,props:["json"],data:function(){return{reviewing:[],submissions:{}}},mounted:function(){this.setTitle("Peer Reviewing"),this.reviewing=this.json.reviewing;var e=this.$refs.editor;this.editor=new this.$site.Editor(e,{height:"10em",classes:["yellow-pad"]});var t,i={},s=$(this.json.submissions);try{for(s.s();!(t=s.n()).done;){var r=t.value;i[r.tag]={id:r.id,date:r.date}}}catch(e){s.e(e)}finally{s.f()}this.submissions=i},methods:{submit:function(){var e=this,t=this.editor.textarea.value.trim();if(""!==t){var i={type:"text/plain",text:t,submissions:this.submissions};this.$site.api.post("/api/review/review/".concat(this.json.id),i).then((function(t){t.hasError()?e.$site.toast(e,t):(e.editor.textarea.value="",e.reviewing=t.getData("reviewing").attributes,e.$site.toast(e,"Review successfully saved to the server"))})).catch((function(t){e.$site.toast(e,t)}))}else Site.toast(this,"You must enter some text to submit")},formatTime:function(e){return this.$site.TimeFormatter.relativeUNIX(e,null)},showSubmissions:function(e){var t=!1,i=e.meta.review.submissions;for(var s in i)i[s].id!==this.submissions[s].id&&(t=!0);return t?"For a past submission":""},previewImg:function(e){return this.$site.root+"/cl/review/img/"+e.id}}};var A=(0,u.Z)(T,C,[function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("input",{attrs:{type:"submit",value:"Submit Review"}})])}],!1,null,null,null);A.options.__file="vendor/cl/review/js/ReviewVue.vue";const I=A.exports;var O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"cl-reviews"},[i("h3",[e._v("Reviews of this assignment appear here.")]),e._v(" "),0===e.reviews.length?i("p",{staticClass:"cl-reviews-none"},[e._v("*** None Yet ***")]):e._e(),e._v(" "),e._l(e.reviews,(function(t){return i("div",{staticClass:"cl-review"},[i("h3",{class:void 0!==t.role?"staff":""},[e._v(e._s(e.formatTime(t.time))+"\n      "),void 0!==t.role?i("span",[e._v("Staff Review")]):i("span",[e._v("Review")]),e._v(" by "+e._s(t.by)+"\n      "),i("span",{staticClass:"cl-submitted"},[e._v(e._s(e.showSubmissions(t)))])]),e._v(" "),i("div",{staticClass:"cl-review-present"},[e._v(e._s(t.review))])])}))],2)};O._withStripped=!0;const U={props:["json"],data:function(){return{assignTag:"",reviews:[]}},mounted:function(){this.assignTag=this.json.assignTag,this.reviews=this.json.reviews},methods:{formatTime:function(e){return this.$site.TimeFormatter.relativeUNIX(e,null)},showSubmissions:function(e){var t="";for(var i in e.submissions)""!==t&&(t+=" / "),t+=this.$site.TimeFormatter.absoluteUNIX(e.submissions[i].date);return""===t?"":"Submission: "+t}}};var k=(0,u.Z)(U,O,[],!1,null,null,null);k.options.__file="vendor/cl/review/js/ReviewsVue.vue";const E=k.exports;void 0!==Site.Site.console&&x.setup(Site.Site.console),Site.Site.ready((function(){Site.Site.PageVue.create("div.cl-review","Review Vue",I),Site.Site.InlineVue.create("div.cl-reviews",E)}))},40836:(e,t,i)=>{i.d(t,{Z:()=>n});var s=i(76433),r=i.n(s)()((function(e){return e[1]}));r.push([e.id,"div.cl-reviewing td.cl-empty{background-color:#e8f7f3}p.cl-reviews-none{text-align:center;color:#00723f;font-style:italic}div.cl-reviews h3{text-align:center;background:#00723f;color:#fff}div.cl-review{margin:1em 0}div.cl-review h3{font-size:.85em;font-style:italic;font-weight:normal;background:transparent;color:#00723f;border-bottom:1px solid #00723f;text-align:left}div.cl-review h3 span.cl-submitted{float:right;color:#00909e;font-size:.9em}div.cl-review h3.staff{color:red}div.cl-review pre{margin:0;white-space:pre-wrap}div.cl-review div.cl-review-present{margin:0;white-space:pre-wrap}",""]);const n=r}},i={};function s(e){var r=i[e];if(void 0!==r)return r.exports;var n=i[e]={id:e,loaded:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}s.m=t,e=[],s.O=(t,i,r,n)=>{if(!i){var a=1/0;for(l=0;l<e.length;l++){for(var[i,r,n]=e[l],o=!0,v=0;v<i.length;v++)(!1&n||a>=n)&&Object.keys(s.O).every((e=>s.O[e](i[v])))?i.splice(v--,1):(o=!1,n<a&&(a=n));o&&(e.splice(l--,1),t=r())}return t}n=n||0;for(var l=e.length;l>0&&e[l-1][2]>n;l--)e[l]=e[l-1];e[l]=[i,r,n]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),s.j=756,(()=>{var e={756:0};s.O.j=t=>0===e[t];var t=(t,i)=>{var r,n,[a,o,v]=i,l=0;for(r in o)s.o(o,r)&&(s.m[r]=o[r]);if(v)var u=v(s);for(t&&t(i);l<a.length;l++)n=a[l],s.o(e,n)&&e[n]&&e[n][0](),e[a[l]]=0;return s.O(u)},i=self.webpackChunkcourselib=self.webpackChunkcourselib||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var r=s.O(void 0,[736],(()=>s(94775)));r=s.O(r)})();