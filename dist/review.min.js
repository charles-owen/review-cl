"use strict";(self.webpackChunkcourselib=self.webpackChunkcourselib||[]).push([[756],{19645:(t,n,e)=>{e(15826);var i=e(34802),o={class:"content"},r={class:"full"},a={class:"cl-submission-view"},s={key:0,class:"cl-preview yellow-pad"},c={class:"cl-preview-time"},l=function(t){return(0,i.dD)("data-v-4831a5ac"),t=t(),(0,i.Cn)(),t}((function(){return(0,i._)("h3",{style:{"text-align":"center",background:"#00723f",color:"white"}},"Review & Chat",-1)})),u={key:0,class:"cl-reviews-none"};var h=e(70019),d=e(64405),v={class:"cl-reviewDrawing"},f={class:"slider-container"},p={class:"cl-preview cl-review-diagram"},g={class:"top-bar"},m={class:"cl-review-diagram"},w=["src"],b=function(t){return(0,i.dD)("data-v-a5f00c68"),t=t(),(0,i.Cn)(),t}((function(){return(0,i._)("canvas",{class:"canvas-drawing",id:"drawing"},null,-1)})),y={ref:"svgImage",id:"drawing-svg",xmlns:"http://www.w3.org/2000/svg"};function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}function x(){return x="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,n,e){var i=function(t,n){for(;!Object.prototype.hasOwnProperty.call(t,n)&&null!==(t=_(t)););return t}(t,n);if(i){var o=Object.getOwnPropertyDescriptor(i,n);return o.get?o.get.call(arguments.length<3?t:e):o.value}},x.apply(this,arguments)}function A(t,n){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},A(t,n)}function k(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&A(t,n)}var C=e(56161);function E(t,n){if(n&&("object"===(0,C.Z)(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function I(t){var n=function(t,n){if("object"!==(0,C.Z)(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,n||"default");if("object"!==(0,C.Z)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"===(0,C.Z)(n)?n:String(n)}function S(t,n,e){return(n=I(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function D(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,I(i.key),i)}}function M(t,n,e){return n&&D(t.prototype,n),e&&D(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function j(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function P(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,i=_(t);if(n){var o=_(this).constructor;e=Reflect.construct(i,arguments,o)}else e=i.apply(this,arguments);return E(this,e)}}var T=M((function t(n,e,i){j(this,t),this.x=n,this.y=e,this.w=i})),O=function(){function t(n){j(this,t),this.handler=n,this.pointer_down=!1}return M(t,[{key:"makePath",value:function(t,n,e){var i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttributeNS(null,"d",t),i.setAttributeNS(null,"stroke",this.handler.color),i.setAttributeNS(null,"stroke-linecap","round"),i.setAttributeNS(null,"stroke-width",n),i.setAttributeNS(null,"fill","transparent"),i.setAttributeNS(null,"data-id",e),document.getElementById("drawing-svg").appendChild(i)}},{key:"getLineWidth",value:function(t){switch(t.pointerType){case"mouse":return 0|this.handler.line_width;case"pen":case"touch":return this.handler.line_width*t.pressure}}},{key:"deletePath",value:function(t){null!==t&&document.querySelectorAll('path[data-id="'.concat(t,'"]')).forEach((function(t){return t.remove()}))}},{key:"doDown",value:function(t){this.pointer_down=!0}},{key:"doUp",value:function(t){this.pointer_down=!1}}]),t}();S(O,"num_paths",0);var Z=function(t){k(e,t);var n=P(e);function e(t){var i;return j(this,e),(i=n.call(this,t)).n=5,i.points=[],i.averaged_points=[],i}return M(e,[{key:"doDown",value:function(t){x(_(e.prototype),"doDown",this).call(this,t)}},{key:"doUp",value:function(t){x(_(e.prototype),"doUp",this).call(this,t),this.drawSplines(this.averaged_points),this.handler.ctx.clearRect(0,0,this.handler.canvas.width,this.handler.canvas.height),this.averaged_points.length=0,this.points.length=0}},{key:"doMove",value:function(t){if(this.pointer_down){var n=t.clientX-this.handler.x_pos,e=t.clientY-this.handler.y_pos;if(this.points.push(new T(n,e,this.getLineWidth(t))),this.points.length==this.n){this.points.shift();var i=this.mean(this.points);this.averaged_points.push(i);var o=this.averaged_points.at(-2),r=this.averaged_points.at(-1);this.drawLine(o,r)}}}},{key:"drawLine",value:function(t,n){void 0===t&&(t=n);var e=new T(n.x-t.x,n.y-t.y),i=Math.atan2(e.y,e.x)-Math.PI/2;this.handler.ctx.beginPath(),this.handler.ctx.arc(n.x,n.y,n.w/2,i,i+Math.PI),this.handler.ctx.arc(t.x,t.y,t.w/2,i+Math.PI,i),this.handler.ctx.closePath(),this.handler.ctx.fillStyle=this.handler.color,this.handler.ctx.fill()}},{key:"drawSplines",value:function(t){if(t.length){for(var n=t[0].x,e=t[0].y,i=1;i<t.length-2;i++){var o="M ".concat(n,",").concat(e," ");n=(t[i].x+t[i+1].x)/2,e=(t[i].y+t[i+1].y)/2,o+="Q ".concat(t[i].x,",").concat(t[i].y," ").concat(n,",").concat(e),this.makePath(o,t[i-1].w,O.num_paths)}o="M ".concat(n,",").concat(e," "),o+="Q ".concat(t[i].x,",").concat(t[i].y," ").concat(t[i+1].x,",").concat(t[i+1].y),this.makePath(o,t[i].w,O.num_paths),O.num_paths+=1}}},{key:"mean",value:function(t){var n=t.reduce((function(t,n){return new T(t.x+n.x,t.y+n.y,t.w+n.w)}));return new T(n.x/t.length,n.y/t.length,n.w/t.length)}}]),e}(O);S(Z,"name","pen");var $=function(t){k(e,t);var n=P(e);function e(t){return j(this,e),n.call(this,t)}return M(e,[{key:"doDown",value:function(t){x(_(e.prototype),"doDown",this).call(this,t),this.doErase(t.clientX,t.clientY)}},{key:"doUp",value:function(t){x(_(e.prototype),"doUp",this).call(this,t)}},{key:"doMove",value:function(t){this.pointer_down&&this.doErase(t.clientX,t.clientY)}},{key:"doErase",value:function(t,n){}}]),e}(O),B=function(t){k(e,t);var n=P(e);function e(){return j(this,e),n.apply(this,arguments)}return M(e,[{key:"doErase",value:function(t,n){var e=document.elementsFromPoint(t,n).find((function(t){return"path"==t.tagName}));void 0!==e&&this.deletePath(e.getAttribute("data-id"))}}]),e}($);S(B,"name","eraser");var z=function(t){k(e,t);var n=P(e);function e(){return j(this,e),n.apply(this,arguments)}return M(e,[{key:"doErase",value:function(t,n){var e=document.elementsFromPoint(t,n).find((function(t){return"path"==t.tagName}));void 0!==e&&e.remove()}}]),e}($);S(z,"name","segment_eraser");var L=function(t){k(e,t);var n=P(e);function e(t){var i;return j(this,e),(i=n.call(this,t)).mouse_start=null,i}return M(e,[{key:"doDown",value:function(t){x(_(e.prototype),"doDown",this).call(this,t),O.num_paths+=1;var n=t.clientX-this.handler.x_pos,i=t.clientY-this.handler.y_pos;this.mouse_start=new T(n,i)}},{key:"doUp",value:function(t){x(_(e.prototype),"doUp",this).call(this,t)}},{key:"doMove",value:function(t){if(this.pointer_down){this.deletePath(O.num_paths);var n=t.clientX-this.handler.x_pos,e=t.clientY-this.handler.y_pos;this.makeShape(this.mouse_start,new T(n,e))}}},{key:"makeShape",value:function(t,n){}}]),e}(O),U=function(t){k(e,t);var n=P(e);function e(){return j(this,e),n.apply(this,arguments)}return M(e,[{key:"makeShape",value:function(t,n){var e="M ".concat(t.x," ").concat(t.y," ");e+="L ".concat(n.x," ").concat(n.y),this.makePath(e,this.handler.line_width,O.num_paths)}}]),e}(L);S(U,"name","line_tool");var R=function(t){k(e,t);var n=P(e);function e(){return j(this,e),n.apply(this,arguments)}return M(e,[{key:"makeShape",value:function(t,n){var e=this.handler.line_width,i=O.num_paths,o=3*e,r=Math.atan2(n.y-t.y,n.x-t.x),a={x:n.x-o*Math.cos(r+Math.PI/6),y:n.y-o*Math.sin(r+Math.PI/6)},s={x:n.x-o*Math.cos(r-Math.PI/6),y:n.y-o*Math.sin(r-Math.PI/6)},c="M ".concat(t.x," ").concat(t.y," L ").concat(n.x," ").concat(n.y),l="M ".concat(a.x," ").concat(a.y," L ").concat(n.x," ").concat(n.y," L ").concat(s.x," ").concat(s.y);this.makePath(c,e,i),this.makePath(l,e,i)}}]),e}(L);S(R,"name","arrow_tool");var N=function(t){k(e,t);var n=P(e);function e(){return j(this,e),n.apply(this,arguments)}return M(e,[{key:"makeShape",value:function(t,n){var e="M ".concat(t.x," ").concat(t.y," H ").concat(n.x," V ").concat(n.y," H ").concat(t.x," Z");this.makePath(e,this.handler.line_width,O.num_paths)}}]),e}(L);S(N,"name","rect_tool");var V=new function(){this.line_width=1,this.tool="pen",this.color="red",this.width=0,this.height=0,this.x_pos=0,this.y_pos=0,this.canvas=null,this.ctx=null,this.svg=null,this.tools=[new Z(this),new B(this),new z(this),new U(this),new R(this),new N(this)],this.setSize=function(t){var n=t.getBoundingClientRect();this.width=n.width,this.height=n.height,this.x_pos=n.x,this.y_pos=n.y,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this.svg.setAttribute("width",this.width),this.svg.setAttribute("height",this.height)},this.init=function(){this.canvas=document.getElementById("drawing"),this.ctx=this.canvas.getContext("2d"),this.svg=document.getElementById("drawing-svg"),this.addListeners(this.canvas),this.addListeners(this.svg)},this.pointerMove=function(t){var n=this;this.tools.find((function(t){return t.constructor.name===n.tool})).doMove(t)},this.pointerDown=function(t){var n=this;this.tools.find((function(t){return t.constructor.name===n.tool})).doDown(t)},this.pointerUp=function(t){var n=this;this.tools.find((function(t){return t.constructor.name===n.tool})).doUp(t)},this.pointerEnter=function(t){"pen"!=t.pointerType&&"touch"!=t.pointerType||(document.body.style.position="fixed",document.body.style.overflowY="scroll")},this.pointerLeave=function(t){"pen"!=t.pointerType&&"touch"!=t.pointerType||(document.body.style.position="static",document.body.style.overflowY="auto")},this.addListeners=function(t){this.pointerDown=this.pointerDown.bind(this),this.pointerUp=this.pointerUp.bind(this),this.pointerMove=this.pointerMove.bind(this),this.pointerEnter=this.pointerEnter.bind(this),this.pointerLeave=this.pointerLeave.bind(this),t.addEventListener("pointerdown",this.pointerDown,!1),t.addEventListener("pointerup",this.pointerUp,!1),t.addEventListener("pointermove",this.pointerMove,!1),t.addEventListener("pointerenter",this.pointerEnter,!1),t.addEventListener("pointerleave",this.pointerLeave,!1)}},Y={props:["submission","image","chat_id"],inheritAttrs:!1,data:function(){return{resizeObserver:null,color:0,customColor:!1,tool:"pen",widthValue:0,annotation_width:0,annotation_height:0,pencil_url:"url("+this.$site.root+"/vendor/cl/site/img/pencil.svg)",eraser_url:"url("+this.$site.root+"/vendor/cl/site/img/eraser.svg)",line_url:"url("+this.$site.root+"/vendor/cl/site/img/line.svg)",arrow_url:"url("+this.$site.root+"/vendor/cl/site/img/arrow.svg)",rectangle_url:"url("+this.$site.root+"/vendor/cl/site/img/rectangle.svg)"}},mounted:function(){this.annotation=this.$refs.svgImage,this.resizeObserver=new ResizeObserver(this.onMutate),this.resizeObserver.observe(document.body),window.addEventListener("scroll",this.onMutate),V.init(),this.onMutate(),this.color="red",this.widthValue=5},beforeUnmount:function(){this.resizeObserver.unobserve(document.body),window.removeEventListener("scroll",this.onMutate)},methods:{submit:function(t){var n=this,e=this.annotation.innerHTML;if(""!==e){var i={annotation:e,width:this.annotation_width,height:this.annotation_height,review_id:t};this.$site.api.post("/api/review/annotate/".concat(this.chat_id),i).then((function(t){t.hasError()&&n.$site.toast(n,t)})).catch((function(t){n.$site.toast(n,t)}))}},onMutate:function(){V.setSize(this.$refs.diagramImage),this.annotation_width=this.$refs.diagramImage.clientWidth,this.annotation_height=this.$refs.diagramImage.clientHeight}},watch:{color:function(t){this.customColor=t.includes("#"),V.color=t},tool:function(t){V.tool=t},widthValue:function(t){V.line_width=t}}},Q=function(){(0,i.sj)((function(t){return{"62a032a6":t.pencil_url,"6c6790a5":t.eraser_url,"7b22504d":t.line_url,"17132bb0":t.arrow_url,b59aa2d4:t.rectangle_url}}))},H=Y.setup;Y.setup=H?function(t,n){return Q(),H(t,n)}:Q;const X=Y;var q=e(68572),F=e.n(q),G=e(84879),W=e.n(G),K=e(55438),J=e.n(K),tt=e(59425),nt=e.n(tt),et=e(37930),it=e.n(et),ot=e(76686),rt=e.n(ot),at=e(58353),st={};st.styleTagTransform=rt(),st.setAttributes=nt(),st.insert=J().bind(null,"head"),st.domAPI=W(),st.insertStyleElement=it();F()(at.Z,st);at.Z&&at.Z.locals&&at.Z.locals;var ct=e(76906);const lt=(0,ct.Z)(X,[["render",function(t,n,e,o,r,a){return(0,i.wg)(),(0,i.iD)("div",v,[(0,i._)("div",f,[(0,i.Uk)(" Line width "),(0,i.wy)((0,i._)("input",{type:"range",min:"1",max:"50",id:"widthSlider","onUpdate:modelValue":n[0]||(n[0]=function(n){return t.widthValue=n}),class:"slider"},null,512),[[i.nr,t.widthValue]]),(0,i.Uk)(" "+(0,i.zw)(t.widthValue),1)]),(0,i._)("figure",p,[(0,i._)("div",g,[(0,i._)("div",{class:(0,i.C_)([{active:"red"==t.color},"button hue-selector red"]),onClick:n[1]||(n[1]=function(n){return t.color="red"})},null,2),(0,i._)("div",{class:(0,i.C_)([{active:"orange"==t.color},"button hue-selector orange"]),onClick:n[2]||(n[2]=function(n){return t.color="orange"})},null,2),(0,i._)("div",{class:(0,i.C_)([{active:"yellow"==t.color},"button hue-selector yellow"]),onClick:n[3]||(n[3]=function(n){return t.color="yellow"})},null,2),(0,i._)("div",{class:(0,i.C_)([{active:"green"==t.color},"button hue-selector green"]),onClick:n[4]||(n[4]=function(n){return t.color="green"})},null,2),(0,i._)("div",{class:(0,i.C_)([{active:"blue"==t.color},"button hue-selector blue"]),onClick:n[5]||(n[5]=function(n){return t.color="blue"})},null,2),(0,i._)("div",{class:(0,i.C_)([{active:"purple"==t.color},"button hue-selector purple"]),onClick:n[6]||(n[6]=function(n){return t.color="purple"})},null,2),(0,i._)("div",{class:(0,i.C_)([{active:"violet"==t.color},"button hue-selector violet"]),onClick:n[7]||(n[7]=function(n){return t.color="violet"})},null,2),(0,i._)("div",{class:(0,i.C_)([{active:t.customColor},"button hue-selector custom"])},[(0,i._)("input",{type:"color",onInput:n[8]||(n[8]=function(n){return t.color=n.target.value})},null,32)],2),(0,i._)("div",{class:(0,i.C_)([{active:"pen"==t.tool},"button pencil"]),onClick:n[9]||(n[9]=function(n){return t.tool="pen"})},null,2),(0,i._)("div",{class:(0,i.C_)([{active:"line_tool"==t.tool},"button linetool"]),onClick:n[10]||(n[10]=function(n){return t.tool="line_tool"})},null,2),(0,i._)("div",{class:(0,i.C_)([{active:"arrow_tool"==t.tool},"button arrowtool"]),onClick:n[11]||(n[11]=function(n){return t.tool="arrow_tool"})},null,2),(0,i._)("div",{class:(0,i.C_)([{active:"rect_tool"==t.tool},"button recttool"]),onClick:n[12]||(n[12]=function(n){return t.tool="rect_tool"})},null,2),(0,i._)("div",{class:(0,i.C_)([{active:"eraser"==t.tool},"button eraser"]),onClick:n[13]||(n[13]=function(n){return t.tool="eraser"})},null,2),(0,i._)("div",{class:(0,i.C_)([{active:"segment_eraser"==t.tool},"button segmenteraser"]),onClick:n[14]||(n[14]=function(n){return t.tool="segment_eraser"})},null,2)]),(0,i._)("div",m,[(0,i._)("img",{ref:"diagramImage",src:e.image},null,8,w),b,((0,i.wg)(),(0,i.iD)("svg",y,null,512))])])])}],["__scopeId","data-v-a5f00c68"]]);function ut(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return ht(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ht(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,r=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw r}}}}function ht(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,i=new Array(n);e<n;e++)i[e]=t[e];return i}const dt={extends:h.Z9,props:["json"],data:function(){return{reviewing:[],submissions:{},chat_id:this.json.id,context:"reviewer"}},components:{reviewChat:d.Z,reviewDrawing:lt},mounted:function(){this.setTitle("Peer Reviewing"),this.reviewing=this.json.reviewing;var t,n={},e=ut(this.json.submissions);try{for(e.s();!(t=e.n()).done;){var i=t.value;n[i.tag]={id:i.id,date:i.date}}}catch(t){e.e(t)}finally{e.f()}this.submissions=n},methods:{submit:function(t){this.$refs.reviewDrawing[0].submit(t)},formatTime:function(t){return this.$site.TimeFormatter.relativeUNIX(t,null)},showSubmissions:function(t){var n=!1,e=t.meta.review.submissions;for(var i in e)e[i].id!==this.submissions[i].id&&(n=!0);return n?"For a past submission":""},previewImg:function(t){return this.$site.root+"/cl/review/img/"+t.id}}};var vt=e(70754),ft={};ft.styleTagTransform=rt(),ft.setAttributes=nt(),ft.insert=J().bind(null,"head"),ft.domAPI=W(),ft.insertStyleElement=it();F()(vt.Z,ft);vt.Z&&vt.Z.locals&&vt.Z.locals;const pt=(0,ct.Z)(dt,[["render",function(t,n,e,h,d,v){var f=(0,i.up)("review-drawing"),p=(0,i.up)("review-chat");return(0,i.wg)(),(0,i.iD)("div",o,[(0,i._)("div",r,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.json.submissions,(function(n){return(0,i.wg)(),(0,i.iD)("div",a,[(0,i._)("h2",null,(0,i.zw)(n.name),1),"text"===n.type?((0,i.wg)(),(0,i.iD)("pre",s,(0,i.zw)(n.text),1)):(0,i.kq)("v-if",!0),"image"===n.type?((0,i.wg)(),(0,i.j4)(f,{key:1,chat_id:t.chat_id,submission:n,image:v.previewImg(n),ref_for:!0,ref:"reviewDrawing"},null,8,["chat_id","submission","image"])):(0,i.kq)("v-if",!0),(0,i._)("p",c,(0,i.zw)(v.formatTime(n.date)),1)])})),256)),l,0===t.reviewing.length?((0,i.wg)(),(0,i.iD)("p",u," *** None Yet *** ")):(0,i.kq)("v-if",!0),(0,i.Wm)(p,{json:e.json,context:t.context,chat_id:t.chat_id,anon_index:0,onSubmit:v.submit},null,8,["json","context","chat_id","onSubmit"])])])}],["__scopeId","data-v-4831a5ac"]]);var gt=e(22518);Site.Review||(Site.ready((function(){Site.PageVue.create("div.cl-review","Review Vue",pt),Site.InlineVue.create("div.cl-reviews",gt.Z)})),Site.Review=!0)},41125:(t,n,e)=>{e.d(n,{Z:()=>s});var i=e(3041),o=e.n(i),r=e(52281),a=e.n(r)()(o());a.push([t.id,"\n.cl-chat-div[data-v-75cb06b6]{\n  cursor: pointer;\n  display: flex;\n  max-height: 48vh;\n  min-height: 10vh;\n  border: solid 1px;\n  overflow-x: hidden;\n  display: flex;\n  flex-direction: column-reverse;\n  margin: 0;\n}\n.cl-chat-bubble[data-v-75cb06b6] {\n  min-width: 40%;\n  max-width: 60%;\n  border: solid 1px;\n  border-radius: 13px;\n  font-size: 12px;\n  padding: 9px 12px;\n  word-wrap: break-word;\n}\n.cl-chat-incoming[data-v-75cb06b6] {\n  float: left;\n  background-color: #eeeeee;\n}\n.cl-chat-outgoing[data-v-75cb06b6]{\n  background-color: #0c5645;\n  color: white;\n  float: right;\n  text-align: left;\n}\n.cl-chat-text[data-v-75cb06b6] {\n  padding: 0;\n  margin: 0;\n}\n.incoming-id[data-v-75cb06b6]{\n  margin:0;\n  color: #204c42;\n  font-weight: bold;\n  font-size: small;\n}\n.cl-chat-format[data-v-75cb06b6] {\n  text-align: right;\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-end;\n}\n.cl-chat-space[data-v-75cb06b6] {\n  margin: 5px;\n}\n.cl-chat-time[data-v-75cb06b6] {\n  opacity: 0.5;\n}\n.cl-chat-input[data-v-75cb06b6] {\n  border: 3px solid;\n  padding-left: 5px;\n}\n.message-div[data-v-75cb06b6] {\n  padding: 5px 10px;\n}\n.message-div[data-v-75cb06b6]:first-child {\n  padding: 5px 10px 10px;\n}\n.form-container[data-v-75cb06b6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 30px;\n  margin-top:15px;\n}\ntextarea[data-v-75cb06b6] {\n  display: block;\n  margin: 0 auto;\n  overflow: hidden;\n  resize: none;\n  border-radius: 8px;\n  shadow: black;\n}\n.sendbutton[data-v-75cb06b6]{\n  margin-left: 10px;\n  border-radius: 3px;\n}\n.edit_input[data-v-75cb06b6]{\n  border:3px solid;\n  color: black;\n  border-radius: 8px;\n  width: 100%;\n}\n.button-container[data-v-75cb06b6] {\n  display: grid;\n  grid-template-columns: 0fr min-content 0fr;\n  grid-gap: 5%;\n}\n.confirm[data-v-75cb06b6]{\n  padding: 3px 4px;\n  background-color: #ffffff;\n  color: black;\n  margin-top: 10px;\n  border-radius: 5px;\n  width: 48px;\n  min-width:2vw;\n  font-size:8px;\n  text-align:center;\n}\n\n",""]);const s=a},58353:(t,n,e)=>{e.d(n,{Z:()=>s});var i=e(3041),o=e.n(i),r=e(52281),a=e.n(r)()(o());a.push([t.id,"\n.top-bar[data-v-a5f00c68] {\n  height: 50px;\n  width: 100%;\n  overflow: hidden;\n\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n\n  background-color: gainsboro;\n}\n.button[data-v-a5f00c68] {\n  width: 30px;\n  height: 30px;\n  cursor: pointer;\n}\n.hue-selector[data-v-a5f00c68] {\n  border-radius: 50%;\n}\n.pencil[data-v-a5f00c68]::before {\n  content: var(--62a032a6);\n}\n.eraser[data-v-a5f00c68]::before {\n  content: var(--6c6790a5);\n}\n.segmenteraser[data-v-a5f00c68]::before {\n  content: var(--6c6790a5);\n  background-color: red;\n}\n.linetool[data-v-a5f00c68]::before {\n  content: var(--7b22504d);\n}\n.arrowtool[data-v-a5f00c68]::before {\n  content: var(--17132bb0);\n}\n.recttool[data-v-a5f00c68]::before {\n  content: var(--b59aa2d4);\n}\n.active[data-v-a5f00c68] {\n  outline:3px solid gray;\n}\n.red[data-v-a5f00c68] { background-color: red;\n}\n.orange[data-v-a5f00c68] { background-color: orange;\n}\n.yellow[data-v-a5f00c68] { background-color: yellow;\n}\n.green[data-v-a5f00c68] { background-color: green;\n}\n.blue[data-v-a5f00c68] { background-color: blue;\n}\n.purple[data-v-a5f00c68] { background-color: purple;\n}\n.violet[data-v-a5f00c68] { background-color: violet;\n}\n.custom[data-v-a5f00c68] {\n  background: conic-gradient(\n        rgba(255, 0, 0, 1) 0%,\n        rgba(255, 154, 0, 1) 10%,\n        rgba(208, 222, 33, 1) 20%,\n        rgba(79, 220, 74, 1) 30%,\n        rgba(63, 218, 216, 1) 40%,\n        rgba(47, 201, 226, 1) 50%,\n        rgba(28, 127, 238, 1) 60%,\n        rgba(95, 21, 242, 1) 70%,\n        rgba(186, 12, 248, 1) 80%,\n        rgba(251, 7, 217, 1) 90%,\n        rgba(255, 0, 0, 1) 100%\n    );\n}\n.slider-container[data-v-a5f00c68] {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n.custom input[data-v-a5f00c68] {\n  opacity: 0;\n}\n\n",""]);const s=a},70754:(t,n,e)=>{e.d(n,{Z:()=>l});var i=e(3041),o=e.n(i),r=e(52281),a=e.n(r),s=e(11701),c=a()(o());c.i(s.Z),c.push([t.id," ",""]);const l=c},98978:(t,n,e)=>{e.d(n,{Z:()=>s});var i=e(3041),o=e.n(i),r=e(52281),a=e.n(r)()(o());a.push([t.id,"div.cl-reviewing td.cl-empty{background-color:#e8f7f3}p.cl-reviews-none{text-align:center;color:#00723f;font-style:italic}div.cl-reviews h3{text-align:center;background:#00723f;color:#fff}div.cl-review{margin:1em 0}div.cl-review h3{font-size:.85em;font-style:italic;font-weight:normal;background:rgba(0,0,0,0);color:#00723f;border-bottom:1px solid #00723f;text-align:left}div.cl-review h3 span.cl-submitted{float:right;color:#00909e;font-size:.9em}div.cl-review h3.staff{color:red}div.cl-review pre{margin:0;white-space:pre-wrap}div.cl-review div.cl-review-present{margin:0;white-space:pre-wrap}",""]);const s=a},11701:(t,n,e)=>{e.d(n,{Z:()=>s});var i=e(3041),o=e.n(i),r=e(52281),a=e.n(r)()(o());a.push([t.id,".cl-review-diagram {\n    position: relative;\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n\n    touch-action: none;\n\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n\n    -moz-user-select: none;\n\n}\n\n.cl-review-diagram img {\n    display: block;\n    width: 100%;\n    height: 100%;\n\n    touch-action: inherit;\n}\n\n.cl-review-diagram svg {\n    position: absolute;\n    top: 0;\n    left: 0;\n\n    z-index: 1;\n\n    touch-action: inherit;\n}\n\n.cl-review-diagram canvas {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n\n    z-index: 2;\n\n    touch-action: inherit;\n}\n",""]);const s=a},15826:(t,n,e)=>{var i=e(68572),o=e.n(i),r=e(84879),a=e.n(r),s=e(55438),c=e.n(s),l=e(59425),u=e.n(l),h=e(37930),d=e.n(h),v=e(76686),f=e.n(v),p=e(98978),g={};g.styleTagTransform=f(),g.setAttributes=u(),g.insert=c().bind(null,"head"),g.domAPI=a(),g.insertStyleElement=d();o()(p.Z,g),p.Z&&p.Z.locals&&p.Z.locals},64405:(t,n,e)=>{e.d(n,{Z:()=>nt});var i=e(34802);var o=function(t){return(0,i.dD)("data-v-75cb06b6"),t=t(),(0,i.Cn)(),t},r={class:"cl-reviewChat"},a={class:"incoming-id"},s={key:0},c={key:1},l={class:"cl-chat-div"},u={key:0,class:"message-div"},h={key:0,class:"cl-review-present cl-chat-bubble cl-chat-outgoing"},d=["id"],v=["id"],f=["value"],p=["id"],g={class:"button-container"},m=["onClick"],w=["onClick"],b={class:"cl-chat-format"},y=["id","onClick"],_=[o((function(){return(0,i._)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAV0lEQVQ4jWNgGHYgFIhT8MgnQ9XgBCDN/4C4CItcEVQumZArCoD4PxBXIokVQsUqCGnGZgjJmtENIUszA5LN6N4hSXMFA/YwIVozDBBtCMXRSHFCGoIAAE1zHz92RVgEAAAAAElFTkSuQmCC"},null,-1)}))],x=["id","onClick"],A=[o((function(){return(0,i._)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAApElEQVQ4jWNgIA2wArEOEAuQqA8M9IH4DhD/B+LvQBxPimYDIH4DxPugLugG4m9AzE+K5r1AzIXkGpBLtMjRzAV1yS0GSJiQrHkvVFwfn2aQ5GsgPgjEPEia9wDxOyA2GYaalRnwB5gBPs0gUA/ET8jVDAJHgXgOqc6GAVBy/A3EC4B4LtQlRNsMAm4MkGQJMuQIA8Q7SsRqBgEOIHZnIDJjoAMALDQzmk2wKtgAAAAASUVORK5CYII="},null,-1)}))],k={class:"cl-chat-time cl-chat-space"},C=["onClick"],E={class:"cl-chat-time"},I={class:"cl-chat-time"},S={ref:"textArea",class:"cl-chat-input",rows:"1",cols:"78",contenteditable:"true"},D=o((function(){return(0,i._)("input",{type:"submit",value:"Send",class:"sendbutton"},null,-1)}));var M={class:"cl-reviewAnnotation"},j={key:0,class:"cl-preview"},P={class:"cl-review-diagram"},T=["src"],O=["innerHTML","height","width"];const Z={props:["chat","review"],inheritAttrs:!1,data:function(){return{annotation:null,width:null,height:null,image_src:null}},mounted:function(){},methods:{},watch:{review:function(t){this.annotation=t.annotation.annotation,this.width=t.annotation.width,this.height=t.annotation.height,this.image_src=this.$site.root+"/cl/course/submission/view/"+Object.values(t.submissions)[0].id}}};var $=e(76906);var B=function(t,n,e){this.reviewChat=e,this.chat_id=n,this.chat=null,this.startPolling=function(){var n=this;t.polling.addClient("chat"+this.chat_hash,(function(t){t.chat={chat_id:n.chat_id}}),(function(t){n.take(t)}))},this.endPolling=function(){t.polling.removeClient("chat"+this.chat_hash)},this.take=function(t){var n=this;this.reviewChat.chat=t.getData("reviewing").attributes.filter((function(t){return n.chat_id===t.by}))};this.chat_hash=function(t){for(var n="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<t;i++)n+=e.charAt(Math.floor(62*Math.random()));return n}(32)};function z(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return L(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return L(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){s=!0,r=t},f:function(){try{a||null==e.return||e.return()}finally{if(s)throw r}}}}function L(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,i=new Array(n);e<n;e++)i[e]=t[e];return i}const U={props:["json","context","chat_id","anon_index"],emit:["submit"],inheritAttrs:!1,data:function(){return{chat:this.json.reviewing.filter(this.filterChatId),selected_review:null,incoming:"reviewer"===this.context?"reviewee":"reviewer",recipient:"",polling:null,showForm:!1,showEdit:!1}},components:{reviewAnnotation:(0,$.Z)(Z,[["render",function(t,n,e,o,r,a){return(0,i.wg)(),(0,i.iD)("div",M,[(0,i.kq)(' <figure v-if="previewImg !== null" class="cl-preview"> '),null!==t.annotation?((0,i.wg)(),(0,i.iD)("figure",j,[(0,i._)("div",P,[(0,i._)("img",{src:t.image_src},null,8,T),((0,i.wg)(),(0,i.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",innerHTML:t.annotation,height:t.height,width:t.width},null,8,O))])])):(0,i.kq)("v-if",!0)])}]])},mounted:function(){var t,n={},e=z(this.json.submissions);try{for(e.s();!(t=e.n()).done;){var i=t.value;n[i.tag]={id:i.id,date:i.date}}}catch(t){e.e(t)}finally{e.f()}var o=this.$refs.textArea;o.addEventListener("input",(function(){o.style.height="auto",o.style.height="".concat(o.scrollHeight,"px")})),this.submissions=n,"-1"!=this.chat_id&&(this.polling=new B(this.$site,this.chat_id,this),this.polling.startPolling()),this.setName()},beforeDestroy:function(){"-1"!=this.chat_id&&this.polling.endPolling()},methods:{submit:function(){var t=this,n=this.$el.querySelector("textarea").value.trim();if(""!==n){var e={type:"text/plain",text:n,submissions:this.submissions,context:this.context};this.$site.api.post("/api/review/review/".concat(this.chat_id),e).then((function(n){if(n.hasError())t.$site.toast(t,n);else{t.$el.querySelector("textarea").value="",t.$nextTick((function(){t.$refs.textArea.style.height=""}));var e=n.getData("reviewing").attributes;t.chat.unshift({by:t.chat_id,review:e.meta.review.review,time:e.time,context:e.meta.review.context}),t.$emit("submit",e.id),t.chat[0].status="displayed"}})).catch((function(n){t.$site.toast(t,n)}))}else Site.toast(this,"You must enter some text to submit")},saveEdit:function(t,n){var e=this,i=document.getElementById("youText"+t).value.trim();""==i&&(i=n);var o={type:"text/plain",text:i};this.$site.api.post("/api/review/editReview/".concat(t),o).then((function(n){if(n.hasError())e.$site.toast(e,n);else{document.getElementById("del"+t),document.getElementById("edit"+t);document.getElementById("show"+t).style.display="none",document.getElementById("p"+t).style.display="block",e.$site.toast(e,"Edit Saved!")}})).catch((function(t){console.log(t)}))},cancel:function(t){document.getElementById("show"+t).style.display="none",document.getElementById("p"+t).style.display="block"},formatTime:function(t){return this.$site.TimeFormatter.relativeUNIX(t,null)},filterChatId:function(t){return this.chat_id==t.by},setName:function(){if(""===this.recipient&&0!==this.chat.length)if(!0===this.chat[0].anonymous){var t="A".charCodeAt(0)+this.anon_index;this.recipient="Student "+String.fromCharCode(t)}else this.recipient=this.chat[0][this.incoming]},deleteContent:function(t){var n=this;new this.$site.Dialog.MessageBox("Are You Sure?","Are you sure you want to delete this message?",this.$site.Dialog.MessageBox.OKCANCEL,(function(){n.$site.api.post("/api/review/removeReview/".concat(t)).then((function(e){if(e.hasError())n.$site.toast(n,e);else{document.getElementById("del"+t),document.getElementById("edit"+t);n.$site.toast(n,"Message Deleted!")}})).catch((function(t){n.$site.toast(n,t)}))}))},editContent:function(t,n){var e=document.getElementById("show"+t),i=document.getElementById("p"+t),o=document.getElementById("youText"+t);"block"==e.style.display?(e.style.display="none",i.style.display="block",o.value=n):(e.style.display="block",i.style.display="none",o.value=n)}}};var R=e(68572),N=e.n(R),V=e(84879),Y=e.n(V),Q=e(55438),H=e.n(Q),X=e(59425),q=e.n(X),F=e(37930),G=e.n(F),W=e(76686),K=e.n(W),J=e(41125),tt={};tt.styleTagTransform=K(),tt.setAttributes=q(),tt.insert=H().bind(null,"head"),tt.domAPI=Y(),tt.insertStyleElement=G();N()(J.Z,tt);J.Z&&J.Z.locals&&J.Z.locals;const nt=(0,$.Z)(U,[["render",function(t,n,e,o,M,j){var P=(0,i.up)("review-annotation");return(0,i.wg)(),(0,i.iD)("div",r,[(0,i.wy)((0,i._)("p",a,[(0,i.Uk)("R"+(0,i.zw)(t.incoming.slice(1))+": ",1),"-1"!==e.chat_id?((0,i.wg)(),(0,i.iD)("span",s,(0,i.zw)(t.recipient),1)):((0,i.wg)(),(0,i.iD)("span",c,"Staff"))],512),[[i.F8,0!==t.chat.length]]),(0,i.wy)((0,i._)("div",l,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.chat,(function(o){return(0,i.wg)(),(0,i.iD)("div",null,["displayed"==o.status||"staff"==o.context?((0,i.wg)(),(0,i.iD)("div",u,[(0,i.kq)(" Outgoing messages"),o.context!==e.context||o.by!=e.chat_id||"displayed"!=o.status&&"staff"!=o.context?null!==o.annotation?((0,i.wg)(),(0,i.iD)(i.HY,{key:1},[(0,i.kq)(" Incoming chats"),"displayed"==o.status||"staff"==o.context?((0,i.wg)(),(0,i.iD)("div",{key:0,onClick:n[1]||(n[1]=(0,i.iM)((function(){}),["stop"])),class:"cl-review-present cl-chat-bubble cl-chat-incoming cl_chat_annotation"},[(0,i._)("a",{href:"#",onClick:(0,i.iM)((function(n){t.selected_review=o}),["prevent"])},(0,i.zw)(o.review),9,C),(0,i._)("div",E,(0,i.zw)(j.formatTime(o.time)),1)])):(0,i.kq)("v-if",!0)],2112)):((0,i.wg)(),(0,i.iD)("div",{key:2,onClick:n[2]||(n[2]=(0,i.iM)((function(){}),["stop"])),class:"cl-review-present cl-chat-bubble cl-chat-incoming"},[(0,i.Uk)((0,i.zw)(o.review)+" ",1),(0,i._)("div",I,(0,i.zw)(j.formatTime(o.time)),1)])):((0,i.wg)(),(0,i.iD)("div",h,[(0,i._)("p",{id:"p"+o.id,class:"cl-chat-text"},(0,i.zw)(o.review),9,d),(0,i._)("form",{action:"",id:"show"+o.id,style:{display:"none"},method:"post",onClick:n[0]||(n[0]=(0,i.iM)((function(){}),["stop"]))},[(0,i._)("input",{type:"hidden",name:"reviewID",value:o.id},null,8,f),(0,i._)("input",{id:"youText"+o.id,type:"text",name:"review",class:"edit_input",value:""},null,8,p),(0,i._)("div",g,[(0,i._)("div",{class:"confirm",onClick:(0,i.iM)((function(t){return j.saveEdit(o.id,o.review)}),["stop"])},"Save",8,m),(0,i._)("div",{class:"confirm",onClick:(0,i.iM)((function(t){return j.cancel(o.id)}),["stop"])},"Cancel",8,w)])],8,v),(0,i._)("div",b,[(0,i._)("button",{id:"del"+o.id,title:"Delete",onClick:(0,i.iM)((function(t){return j.deleteContent(o.id)}),["stop"])},_,8,y),(0,i._)("button",{id:"edit"+o.id,title:"Edit",onClick:(0,i.iM)((function(t){return j.editContent(o.id,o.review)}),["stop"])},A,8,x),(0,i._)("div",k,(0,i.zw)(j.formatTime(o.time)),1)])]))])):(0,i.kq)("v-if",!0)])})),256))],512),[[i.F8,0!==t.chat.length]]),(0,i.wy)((0,i._)("form",{id:"form",method:"post",onSubmit:n[3]||(n[3]=(0,i.iM)((function(){return j.submit&&j.submit.apply(j,arguments)}),["prevent"])),class:"form-container",onClick:n[4]||(n[4]=(0,i.iM)((function(){}),["stop"]))},[(0,i._)("textarea",S,null,512),D],544),[[i.F8,!(0===t.chat.length&&"reviewee"===e.context)&&"-1"!==e.chat_id]]),(0,i._)("div",{onClick:n[5]||(n[5]=(0,i.iM)((function(){}),["stop"]))},[(0,i.Wm)(P,{chat:t.chat,review:t.selected_review},null,8,["chat","review"])])])}],["__scopeId","data-v-75cb06b6"]])},22518:(t,n,e)=>{e.d(n,{Z:()=>l});var i=e(34802),o={class:"cl-reviews"},r=(0,i._)("h3",null,"Reviews of this assignment appear here.",-1),a={key:0,class:"cl-reviews-none"},s={class:"cl-review"};const c={props:["json"],data:function(){return{assignTag:"",shownAnnotation:null,reviewing:[],context:"reviewee"}},components:{reviewChat:e(64405).Z},mounted:function(){this.assignTag=this.json.assignTag,this.reviewing=this.json.reviewing},methods:{formatTime:function(t){return this.$site.TimeFormatter.relativeUNIX(t,null)},showSubmissions:function(t){var n="";for(var e in t.submissions)""!==n&&(n+=" / "),n+=this.$site.TimeFormatter.absoluteUNIX(t.submissions[e].date);return""===n?"":"Submission: "+n},show:function(t,n,e,i){this.shownAnnotation={svg:t,width:n,height:e,image_src:i}}}};const l=(0,e(76906).Z)(c,[["render",function(t,n,e,c,l,u){var h=(0,i.up)("review-chat");return(0,i.wg)(),(0,i.iD)("div",o,[r,0===t.reviewing.length?((0,i.wg)(),(0,i.iD)("p",a,"*** None Yet ***")):(0,i.kq)("v-if",!0),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.json.ids,(function(n,o){return(0,i.wg)(),(0,i.iD)("div",s,[(0,i.Wm)(h,{json:e.json,context:t.context,chat_id:n[0],anon_index:o},null,8,["json","context","chat_id","anon_index"])])})),256))])}]])}},t=>{t.O(0,[736,77,530,592],(()=>{return n=19645,t(t.s=n);var n}));t.O()}]);